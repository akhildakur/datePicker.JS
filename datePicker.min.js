/*
Framework Name - datePicker.js
Version - 0.1
Dated - 20/04/2018
Designed for - Front End Web Apps only
Author - Akhil Dakur
License - MIT
***   Suggestions are accepted   ***
*/
(function(){var root = this;if(root != window){root = window;}root.datePickerDotJS = function datePickerDotJS(conf){var owner = this;if(conf===undefined||typeof(conf)!= "object")throw "(datePickerDotJS) Invalid parameter type, needed object type !";if(!conf.hasOwnProperty("el"))throw "(datePickerDotJS) Element not passed !";var w,dp,el,model,dps,df,outType,h,hs,hnblsy,hnbrsy,hnbs,mns,ys,hnbHover,b,bs,brsHover,wns,ts,rs,ws,wt;el = document.querySelector(conf.el);if(!el)throw "(datePickerDotJS) Passed Element does not exist !";function checkString(v){if(v == "")return undefined;else return v;}function checkStyle(v){if(v){if(typeof(v) != "string")throw "(datePickerDotJS) Invalid Style Type [ Not a string ] !";else return v;}else{return "";}}dps = "position:absolute;width:400px;height:350px;z-index:3;display:block;box-shadow:0px 1px 7px #666;"+checkStyle(conf.dp.style);hs = "height:20%;width:100%;background-color:white;display:grid;grid-template-columns:15% 45% 15% 15%;justify-content:center;align-content:center;"+checkStyle(conf.dp.head.style);hnbs = "text-align:center;padding:0px 10px;border-radius:3px;font-size:2.2em;cursor:default;"+checkStyle(conf.dp.head.navBtns.style);hnbHover = "background-color:#d8eaf8;color:#3580eb;"+checkStyle(conf.dp.head.navBtns.styleOnHover);mns = "font-size:1.4em;text-align:center;align-self:center;cursor:default;"+checkStyle(conf.dp.head.styleMonthName);ys = "font-size:1.6em;text-align:center;align-self:center;cursor:default;"+checkStyle(conf.dp.head.styleYear);bs ="height:80%;width:100%;background-color:#f9f9f9;display:grid;grid-template-columns:auto auto auto auto auto auto auto;grid-template-rows:14% 14% 14% 14% 14% 14% 14%;"+checkStyle(conf.dp.body.style);wns = "text-align:center;padding:5px;align-self:center;cursor:default;"+checkStyle(conf.dp.head.styleWeekNames);ts = "text-align:center;padding:5px;background-color:#3580eb;color:#d8eaf8;align-self:center;cursor:default;border-radius:4px;"+checkStyle(conf.dp.body.dateStyle.styleToday);rs="text-align:center;padding:5px;background-color:transparent;color:black;align-self:center;cursor:default;border-radius:4px;"+checkStyle(conf.dp.body.dateStyle.styleRest);brsHover = "background-color:#d8eaf8;color:#3580eb;"+checkStyle(conf.dp.body.dateStyle.styleOnHover);ws = "position:relative;display:inline-block;"+checkStyle(conf.wrapper.style);[model="regular",outType="insert-value",df="dd-mm-yyyy",hnblsy="<",hnbrsy=">",wt="SPAN"]=[checkString(conf.dp.model),checkString(conf.dp.outType),checkString(conf.dp.dateFormat),checkString(conf.dp.head.navBtns.leftBtnSymbol),checkString(conf.dp.head.navBtns.rightBtnSymbol),checkString(conf.wrapper.tag)];if(!document.head.querySelector("#dp-style")){var s = document.createElement("STYLE");s.id = "dp-style";s.innerHTML = `.dp{${dps}}.dp-hide{display:none !important;}.dp-head{${hs}}.dp-navBtns{${hnbs}}.dp-navBtns:hover{${hnbHover}}.dp-month{${mns}}.dp-year{${ys}}.dp-body{${bs}}.dp-week{${wns}}.dp-tday{${ts}}.dp-rest{${rs}}.dp-rest:hover{${brsHover}}.dp-wrapper{${ws}}`;document.head.appendChild(s);}w  = document.createElement(wt.toUpperCase());w.className = "dp-wrapper";el.parentElement.insertBefore(w,el);w.appendChild(el);dp = document.createElement("DIV");dp.className = "dp dp-hide";h = document.createElement("DIV");h.className = "dp-head";b = document.createElement("DIV");b.className = "dp-body";var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],days = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],cell,lBtn,rBtn,mn,fy,dstr=[0,0],leftBtnClick=function(){dstr[1]-=1;setCalendar();},rightBtnClick=function(){dstr[1]+=1;setCalendar();};function getFormatedDate(tar){var d = tar.innerHTML.trim(),m = months.indexOf(tar.parentElement.previousElementSibling.children[1].innerHTML.trim())+1,y = tar.parentElement.previousElementSibling.children[2].innerHTML.trim(),yf = df.match(/y/gi).length,nd;nd = df.replace(/d{1,2}/,d);nd = nd.replace(/m{1,2}/,m);if(yf==2)nd=nd.replace(/y{2}/,y.slice(2));else nd=nd.replace(/y{4}/,y);return nd;}el.addEventListener("focus",function(){this.parentElement.querySelector(".dp").className = "dp"});document.body.addEventListener("click",function(e){var ci = ["dp-navBtns","dp-week","dp-null","dp-head","dp-body","dp-month","dp-year"];if(e.target != dp && e.target != el && ci.indexOf(e.target.className) < 0)dp.className="dp dp-hide";});function insertValue(){el.value=getFormatedDate(this);}function returnValue(){owner.selectedDate=getFormatedDate(this);}function exitDP(){if(this.className == "dp-rest" || this.class == "dp-tday"){this.parentElement.parentElement.className = "dp dp-hide";}}cell = document.createElement("SPAN");cell.className = "dp-navBtns";cell.innerHTML = hnblsy;cell.addEventListener("click",leftBtnClick);h.appendChild(cell);cell = document.createElement("SPAN");cell.className = "dp-month";cell.innerHTML = months[new Date().getMonth()];h.appendChild(cell);cell = document.createElement("SPAN");cell.className = "dp-year";cell.innerHTML = new Date().getFullYear();h.appendChild(cell);cell = document.createElement("SPAN");cell.className = "dp-navBtns";cell.innerHTML = hnbrsy;cell.addEventListener("click",rightBtnClick);h.appendChild(cell);function setCalendar(){var td = new Date();if((dstr[1]+td.getMonth()) == 12)dstr[1]=-td.getMonth(),dstr[0]+=1;if(dstr[1]+td.getMonth()==-1)dstr[1]=11-td.getMonth(),dstr[0]-=1;var nod = new Date(td.getFullYear()+dstr[0],td.getMonth()+1+dstr[1],0).getDate(),sdom = new Date(td.getFullYear()+dstr[0],td.getMonth()+dstr[1],1).getDay(),pd =td.getDate();h.children[1].innerHTML = months[td.getMonth()+dstr[1]];h.children[2].innerHTML = td.getFullYear()+dstr[0];b.innerHTML = "";for(var i=0;i<days.length;i++){cell = document.createElement("SPAN");cell.className = "dp-week";cell.innerHTML = days[i];b.appendChild(cell);}for(i=0;i<sdom;i++){cell = document.createElement("SPAN");cell.className ="dp-null";cell.innerHTML = "";b.appendChild(cell);}for(i=1;i<=nod;i++){cell = document.createElement("SPAN");if(i==pd && months[td.getMonth()] == h.children[1].innerHTML.trim() && td.getFullYear() == h.children[2].innerHTML.trim() )cell.className = "dp-tday";else cell.className = "dp-rest";cell.innerHTML = i;if(outType == "insert-value") cell.addEventListener("click",insertValue);else cell.addEventListener("click",returnValue);cell.addEventListener("click",exitDP);b.appendChild(cell);}}setCalendar();dp.appendChild(h);dp.appendChild(b);w.appendChild(dp);}}());
